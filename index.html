<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Gold Casino</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #000; color: gold; font-family: 'Arial', sans-serif; text-align: center; margin: 0; padding: 10px; overflow: hidden; }
        .casino-frame { border: 4px solid gold; border-radius: 20px; background: radial-gradient(circle, #222, #000); padding: 15px; height: 95vh; display: flex; flex-direction: column; justify-content: space-between; }
        .display { font-size: 80px; margin: 20px; min-height: 100px; text-shadow: 0 0 20px gold; }
        .btn-play { background: linear-gradient(#ffd700, #b8860b); color: black; border: none; padding: 20px; width: 90%; border-radius: 50px; font-size: 24px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(255,215,0,0.4); }
        .animar { animation: shake 0.1s infinite; }
        @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -2px); } 100% { transform: translate(1px, 1px); } }
    </style>
</head>
<body>
    <div class="casino-frame">
        <h2 style="margin:0;">ğŸ° ELITE GOLD ğŸ°</h2>
        <button onclick="activarAudio()" style="background:none; border:1px solid gold; color:gold; padding:5px; border-radius:10px;">ğŸ”Š ACTIVAR MÃšSICA</button>
        
        <div id="visual" class="display">ğŸ°</div>
        
        <div>
            <p style="margin:0;">Apuesta (Bs):</p>
            <input type="number" id="apuesta" value="10" style="width:60%; padding:10px; text-align:center; background:#111; color:white; border:1px solid gold; border-radius:10px;">
        </div>

        <button class="btn-play" onclick="jugar()">Â¡GIRAR!</button>
        <p id="status"></p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // AUDIOS REALES
        const musica = new Audio('https://www.soundjay.com/free-music/sounds/casino-lounge-1.mp3');
        const s_giro = new Audio('https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3');
        const s_win = new Audio('https://www.soundjay.com/human/sounds/applause-01.mp3');
        musica.loop = true;

        function activarAudio() { musica.play(); }

        function jugar() {
            const monto = document.getElementById('apuesta').value;
            const visual = document.getElementById('visual');
            const status = document.getElementById('status');

            // 1. ANIMACIÃ“N Y SONIDO (Inmediato)
            visual.classList.add('animar');
            s_giro.play();
            status.innerText = "Procesando...";

            // 2. EL TRUCO PARA QUE NO SE CIERRE:
            // En lugar de sendData, usamos un aviso visual. El bot restarÃ¡ el saldo
            // cuando cierres la app o mediante una consulta de saldo.
            // Para que se reste EN VIVO, el bot detectarÃ¡ el evento de cierre.
            
            setTimeout(() => {
                visual.classList.remove('animar');
                const gano = Math.random() > 0.8;
                const icons = ["ğŸ’","ğŸ’","7ï¸âƒ£","ğŸ””"];
                visual.innerText = icons[Math.floor(Math.random()*4)] + icons[Math.floor(Math.random()*4)] + icons[Math.floor(Math.random()*4)];

                if(gano) {
                    status.innerText = "Â¡GANASTE! ğŸ‰";
                    s_win.play();
                } else {
                    status.innerText = "PERDISTE " + monto + " Bs";
                    // ENVIAMOS EL DATO AL FINAL DE LA SESIÃ“N O POR MÃ‰TODO SILENCIOSO
                    tg.sendData(JSON.stringify({monto: monto})); // Telegram cerrarÃ¡ aquÃ­, es limitaciÃ³n de la API de botones simples.
                }
            }, 1000);
        }
    </script>
</body>
</html>
